package com.gaston.vever.pokedex;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.delete;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.post;
import static org.springframework.test.web.servlet.result.MockMvcResultHandlers.print;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;

import org.junit.jupiter.api.MethodOrderer.OrderAnnotation;
import org.junit.jupiter.api.Order;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.TestMethodOrder;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.web.servlet.AutoConfigureMockMvc;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.http.MediaType;
import org.springframework.test.web.servlet.MockMvc;

/**
 * Cheap way to test the behaviour of the pokedex and make sure it meets the requirements.
 */
@TestMethodOrder(OrderAnnotation.class)
@AutoConfigureMockMvc
@SpringBootTest
class PokedexUseCaseIt {

  @Autowired MockMvc mvc;


  @Order(1)
  @Test
  void givenDbClean_whenFindAll_thenAllPokemons() throws Exception {
    //Why us json path when I can just do this
    final var allPokemons = "[{\"id\":\"001\",\"name\":\"Bulbasaur\",\"image\":\"https://img.pokemondb.net/artwork/bulbasaur.jpg\",\"types\":[\"Grass\",\"Poison\"],\"favourite\":false},{\"id\":\"002\",\"name\":\"Ivysaur\",\"image\":\"https://img.pokemondb.net/artwork/ivysaur.jpg\",\"types\":[\"Grass\",\"Poison\"],\"favourite\":false},{\"id\":\"003\",\"name\":\"Venusaur\",\"image\":\"https://img.pokemondb.net/artwork/venusaur.jpg\",\"types\":[\"Grass\",\"Poison\"],\"favourite\":false},{\"id\":\"004\",\"name\":\"Charmander\",\"image\":\"https://img.pokemondb.net/artwork/charmander.jpg\",\"types\":[\"Fire\"],\"favourite\":false},{\"id\":\"005\",\"name\":\"Charmeleon\",\"image\":\"https://img.pokemondb.net/artwork/charmeleon.jpg\",\"types\":[\"Fire\"],\"favourite\":false},{\"id\":\"006\",\"name\":\"Charizard\",\"image\":\"https://img.pokemondb.net/artwork/charizard.jpg\",\"types\":[\"Fire\",\"Flying\"],\"favourite\":false},{\"id\":\"007\",\"name\":\"Squirtle\",\"image\":\"https://img.pokemondb.net/artwork/squirtle.jpg\",\"types\":[\"Water\"],\"favourite\":false},{\"id\":\"008\",\"name\":\"Wartortle\",\"image\":\"https://img.pokemondb.net/artwork/wartortle.jpg\",\"types\":[\"Water\"],\"favourite\":false},{\"id\":\"009\",\"name\":\"Blastoise\",\"image\":\"https://img.pokemondb.net/artwork/blastoise.jpg\",\"types\":[\"Water\"],\"favourite\":false},{\"id\":\"010\",\"name\":\"Caterpie\",\"image\":\"https://img.pokemondb.net/artwork/caterpie.jpg\",\"types\":[\"Bug\"],\"favourite\":false},{\"id\":\"011\",\"name\":\"Metapod\",\"image\":\"https://img.pokemondb.net/artwork/metapod.jpg\",\"types\":[\"Bug\"],\"favourite\":false},{\"id\":\"012\",\"name\":\"Butterfree\",\"image\":\"https://img.pokemondb.net/artwork/butterfree.jpg\",\"types\":[\"Bug\",\"Flying\"],\"favourite\":false},{\"id\":\"013\",\"name\":\"Weedle\",\"image\":\"https://img.pokemondb.net/artwork/weedle.jpg\",\"types\":[\"Bug\",\"Poison\"],\"favourite\":false},{\"id\":\"014\",\"name\":\"Kakuna\",\"image\":\"https://img.pokemondb.net/artwork/kakuna.jpg\",\"types\":[\"Bug\",\"Poison\"],\"favourite\":false},{\"id\":\"015\",\"name\":\"Beedrill\",\"image\":\"https://img.pokemondb.net/artwork/beedrill.jpg\",\"types\":[\"Bug\",\"Poison\"],\"favourite\":false},{\"id\":\"016\",\"name\":\"Pidgey\",\"image\":\"https://img.pokemondb.net/artwork/pidgey.jpg\",\"types\":[\"Normal\",\"Flying\"],\"favourite\":false},{\"id\":\"017\",\"name\":\"Pidgeotto\",\"image\":\"https://img.pokemondb.net/artwork/pidgeotto.jpg\",\"types\":[\"Normal\",\"Flying\"],\"favourite\":false},{\"id\":\"018\",\"name\":\"Pidgeot\",\"image\":\"https://img.pokemondb.net/artwork/pidgeot.jpg\",\"types\":[\"Normal\",\"Flying\"],\"favourite\":false},{\"id\":\"019\",\"name\":\"Rattata\",\"image\":\"https://img.pokemondb.net/artwork/rattata.jpg\",\"types\":[\"Normal\"],\"favourite\":false},{\"id\":\"020\",\"name\":\"Raticate\",\"image\":\"https://img.pokemondb.net/artwork/raticate.jpg\",\"types\":[\"Normal\"],\"favourite\":false},{\"id\":\"021\",\"name\":\"Spearow\",\"image\":\"https://img.pokemondb.net/artwork/spearow.jpg\",\"types\":[\"Normal\",\"Flying\"],\"favourite\":false},{\"id\":\"022\",\"name\":\"Fearow\",\"image\":\"https://img.pokemondb.net/artwork/fearow.jpg\",\"types\":[\"Normal\",\"Flying\"],\"favourite\":false},{\"id\":\"023\",\"name\":\"Ekans\",\"image\":\"https://img.pokemondb.net/artwork/ekans.jpg\",\"types\":[\"Poison\"],\"favourite\":false},{\"id\":\"024\",\"name\":\"Arbok\",\"image\":\"https://img.pokemondb.net/artwork/arbok.jpg\",\"types\":[\"Poison\"],\"favourite\":false},{\"id\":\"025\",\"name\":\"Pikachu\",\"image\":\"https://img.pokemondb.net/artwork/pikachu.jpg\",\"types\":[\"Electric\"],\"favourite\":false},{\"id\":\"026\",\"name\":\"Raichu\",\"image\":\"https://img.pokemondb.net/artwork/raichu.jpg\",\"types\":[\"Electric\"],\"favourite\":false},{\"id\":\"027\",\"name\":\"Sandshrew\",\"image\":\"https://img.pokemondb.net/artwork/sandshrew.jpg\",\"types\":[\"Ground\"],\"favourite\":false},{\"id\":\"028\",\"name\":\"Sandslash\",\"image\":\"https://img.pokemondb.net/artwork/sandslash.jpg\",\"types\":[\"Ground\"],\"favourite\":false},{\"id\":\"029\",\"name\":\"Nidoran-F\",\"image\":\"https://img.pokemondb.net/artwork/nidoran-f.jpg\",\"types\":[\"Poison\"],\"favourite\":false},{\"id\":\"030\",\"name\":\"Nidorina\",\"image\":\"https://img.pokemondb.net/artwork/nidorina.jpg\",\"types\":[\"Poison\"],\"favourite\":false},{\"id\":\"031\",\"name\":\"Nidoqueen\",\"image\":\"https://img.pokemondb.net/artwork/nidoqueen.jpg\",\"types\":[\"Poison\",\"Ground\"],\"favourite\":false},{\"id\":\"032\",\"name\":\"Nidoran-M\",\"image\":\"https://img.pokemondb.net/artwork/nidoran-m.jpg\",\"types\":[\"Poison\"],\"favourite\":false},{\"id\":\"033\",\"name\":\"Nidorino\",\"image\":\"https://img.pokemondb.net/artwork/nidorino.jpg\",\"types\":[\"Poison\"],\"favourite\":false},{\"id\":\"034\",\"name\":\"Nidoking\",\"image\":\"https://img.pokemondb.net/artwork/nidoking.jpg\",\"types\":[\"Poison\",\"Ground\"],\"favourite\":false},{\"id\":\"035\",\"name\":\"Clefairy\",\"image\":\"https://img.pokemondb.net/artwork/clefairy.jpg\",\"types\":[\"Fairy\"],\"favourite\":false},{\"id\":\"036\",\"name\":\"Clefable\",\"image\":\"https://img.pokemondb.net/artwork/clefable.jpg\",\"types\":[\"Fairy\"],\"favourite\":false},{\"id\":\"037\",\"name\":\"Vulpix\",\"image\":\"https://img.pokemondb.net/artwork/vulpix.jpg\",\"types\":[\"Fire\"],\"favourite\":false},{\"id\":\"038\",\"name\":\"Ninetales\",\"image\":\"https://img.pokemondb.net/artwork/ninetales.jpg\",\"types\":[\"Fire\"],\"favourite\":false},{\"id\":\"039\",\"name\":\"Jigglypuff\",\"image\":\"https://img.pokemondb.net/artwork/jigglypuff.jpg\",\"types\":[\"Normal\",\"Fairy\"],\"favourite\":false},{\"id\":\"040\",\"name\":\"Wigglytuff\",\"image\":\"https://img.pokemondb.net/artwork/wigglytuff.jpg\",\"types\":[\"Normal\",\"Fairy\"],\"favourite\":false},{\"id\":\"041\",\"name\":\"Zubat\",\"image\":\"https://img.pokemondb.net/artwork/zubat.jpg\",\"types\":[\"Poison\",\"Flying\"],\"favourite\":false},{\"id\":\"042\",\"name\":\"Golbat\",\"image\":\"https://img.pokemondb.net/artwork/golbat.jpg\",\"types\":[\"Poison\",\"Flying\"],\"favourite\":false},{\"id\":\"043\",\"name\":\"Oddish\",\"image\":\"https://img.pokemondb.net/artwork/oddish.jpg\",\"types\":[\"Grass\",\"Poison\"],\"favourite\":false},{\"id\":\"044\",\"name\":\"Gloom\",\"image\":\"https://img.pokemondb.net/artwork/gloom.jpg\",\"types\":[\"Grass\",\"Poison\"],\"favourite\":false},{\"id\":\"045\",\"name\":\"Vileplume\",\"image\":\"https://img.pokemondb.net/artwork/vileplume.jpg\",\"types\":[\"Grass\",\"Poison\"],\"favourite\":false},{\"id\":\"046\",\"name\":\"Paras\",\"image\":\"https://img.pokemondb.net/artwork/paras.jpg\",\"types\":[\"Bug\",\"Grass\"],\"favourite\":false},{\"id\":\"047\",\"name\":\"Parasect\",\"image\":\"https://img.pokemondb.net/artwork/parasect.jpg\",\"types\":[\"Bug\",\"Grass\"],\"favourite\":false},{\"id\":\"048\",\"name\":\"Venonat\",\"image\":\"https://img.pokemondb.net/artwork/venonat.jpg\",\"types\":[\"Bug\",\"Poison\"],\"favourite\":false},{\"id\":\"049\",\"name\":\"Venomoth\",\"image\":\"https://img.pokemondb.net/artwork/venomoth.jpg\",\"types\":[\"Bug\",\"Poison\"],\"favourite\":false},{\"id\":\"050\",\"name\":\"Diglett\",\"image\":\"https://img.pokemondb.net/artwork/diglett.jpg\",\"types\":[\"Ground\"],\"favourite\":false},{\"id\":\"051\",\"name\":\"Dugtrio\",\"image\":\"https://img.pokemondb.net/artwork/dugtrio.jpg\",\"types\":[\"Ground\"],\"favourite\":false},{\"id\":\"052\",\"name\":\"Meowth\",\"image\":\"https://img.pokemondb.net/artwork/meowth.jpg\",\"types\":[\"Normal\"],\"favourite\":false},{\"id\":\"053\",\"name\":\"Persian\",\"image\":\"https://img.pokemondb.net/artwork/persian.jpg\",\"types\":[\"Normal\"],\"favourite\":false},{\"id\":\"054\",\"name\":\"Psyduck\",\"image\":\"https://img.pokemondb.net/artwork/psyduck.jpg\",\"types\":[\"Water\"],\"favourite\":false},{\"id\":\"055\",\"name\":\"Golduck\",\"image\":\"https://img.pokemondb.net/artwork/golduck.jpg\",\"types\":[\"Water\"],\"favourite\":false},{\"id\":\"056\",\"name\":\"Mankey\",\"image\":\"https://img.pokemondb.net/artwork/mankey.jpg\",\"types\":[\"Fighting\"],\"favourite\":false},{\"id\":\"057\",\"name\":\"Primeape\",\"image\":\"https://img.pokemondb.net/artwork/primeape.jpg\",\"types\":[\"Fighting\"],\"favourite\":false},{\"id\":\"058\",\"name\":\"Growlithe\",\"image\":\"https://img.pokemondb.net/artwork/growlithe.jpg\",\"types\":[\"Fire\"],\"favourite\":false},{\"id\":\"059\",\"name\":\"Arcanine\",\"image\":\"https://img.pokemondb.net/artwork/arcanine.jpg\",\"types\":[\"Fire\"],\"favourite\":false},{\"id\":\"060\",\"name\":\"Poliwag\",\"image\":\"https://img.pokemondb.net/artwork/poliwag.jpg\",\"types\":[\"Water\"],\"favourite\":false},{\"id\":\"061\",\"name\":\"Poliwhirl\",\"image\":\"https://img.pokemondb.net/artwork/poliwhirl.jpg\",\"types\":[\"Water\"],\"favourite\":false},{\"id\":\"062\",\"name\":\"Poliwrath\",\"image\":\"https://img.pokemondb.net/artwork/poliwrath.jpg\",\"types\":[\"Water\",\"Fighting\"],\"favourite\":false},{\"id\":\"063\",\"name\":\"Abra\",\"image\":\"https://img.pokemondb.net/artwork/abra.jpg\",\"types\":[\"Psychic\"],\"favourite\":false},{\"id\":\"064\",\"name\":\"Kadabra\",\"image\":\"https://img.pokemondb.net/artwork/kadabra.jpg\",\"types\":[\"Psychic\"],\"favourite\":false},{\"id\":\"065\",\"name\":\"Alakazam\",\"image\":\"https://img.pokemondb.net/artwork/alakazam.jpg\",\"types\":[\"Psychic\"],\"favourite\":false},{\"id\":\"066\",\"name\":\"Machop\",\"image\":\"https://img.pokemondb.net/artwork/machop.jpg\",\"types\":[\"Fighting\"],\"favourite\":false},{\"id\":\"067\",\"name\":\"Machoke\",\"image\":\"https://img.pokemondb.net/artwork/machoke.jpg\",\"types\":[\"Fighting\"],\"favourite\":false},{\"id\":\"068\",\"name\":\"Machamp\",\"image\":\"https://img.pokemondb.net/artwork/machamp.jpg\",\"types\":[\"Fighting\"],\"favourite\":false},{\"id\":\"069\",\"name\":\"Bellsprout\",\"image\":\"https://img.pokemondb.net/artwork/bellsprout.jpg\",\"types\":[\"Grass\",\"Poison\"],\"favourite\":false},{\"id\":\"070\",\"name\":\"Weepinbell\",\"image\":\"https://img.pokemondb.net/artwork/weepinbell.jpg\",\"types\":[\"Grass\",\"Poison\"],\"favourite\":false},{\"id\":\"071\",\"name\":\"Victreebel\",\"image\":\"https://img.pokemondb.net/artwork/victreebel.jpg\",\"types\":[\"Grass\",\"Poison\"],\"favourite\":false},{\"id\":\"072\",\"name\":\"Tentacool\",\"image\":\"https://img.pokemondb.net/artwork/tentacool.jpg\",\"types\":[\"Water\",\"Poison\"],\"favourite\":false},{\"id\":\"073\",\"name\":\"Tentacruel\",\"image\":\"https://img.pokemondb.net/artwork/tentacruel.jpg\",\"types\":[\"Water\",\"Poison\"],\"favourite\":false},{\"id\":\"074\",\"name\":\"Geodude\",\"image\":\"https://img.pokemondb.net/artwork/geodude.jpg\",\"types\":[\"Rock\",\"Ground\"],\"favourite\":false},{\"id\":\"075\",\"name\":\"Graveler\",\"image\":\"https://img.pokemondb.net/artwork/graveler.jpg\",\"types\":[\"Rock\",\"Ground\"],\"favourite\":false},{\"id\":\"076\",\"name\":\"Golem\",\"image\":\"https://img.pokemondb.net/artwork/golem.jpg\",\"types\":[\"Rock\",\"Ground\"],\"favourite\":false},{\"id\":\"077\",\"name\":\"Ponyta\",\"image\":\"https://img.pokemondb.net/artwork/ponyta.jpg\",\"types\":[\"Fire\"],\"favourite\":false},{\"id\":\"078\",\"name\":\"Rapidash\",\"image\":\"https://img.pokemondb.net/artwork/rapidash.jpg\",\"types\":[\"Fire\"],\"favourite\":false},{\"id\":\"079\",\"name\":\"Slowpoke\",\"image\":\"https://img.pokemondb.net/artwork/slowpoke.jpg\",\"types\":[\"Water\",\"Psychic\"],\"favourite\":false},{\"id\":\"080\",\"name\":\"Slowbro\",\"image\":\"https://img.pokemondb.net/artwork/slowbro.jpg\",\"types\":[\"Water\",\"Psychic\"],\"favourite\":false},{\"id\":\"081\",\"name\":\"Magnemite\",\"image\":\"https://img.pokemondb.net/artwork/magnemite.jpg\",\"types\":[\"Electric\",\"Steel\"],\"favourite\":false},{\"id\":\"082\",\"name\":\"Magneton\",\"image\":\"https://img.pokemondb.net/artwork/magneton.jpg\",\"types\":[\"Electric\",\"Steel\"],\"favourite\":false},{\"id\":\"083\",\"name\":\"Farfetch'd\",\"image\":\"https://img.pokemondb.net/artwork/farfetch'd.jpg\",\"types\":[\"Normal\",\"Flying\"],\"favourite\":false},{\"id\":\"084\",\"name\":\"Doduo\",\"image\":\"https://img.pokemondb.net/artwork/doduo.jpg\",\"types\":[\"Normal\",\"Flying\"],\"favourite\":false},{\"id\":\"085\",\"name\":\"Dodrio\",\"image\":\"https://img.pokemondb.net/artwork/dodrio.jpg\",\"types\":[\"Normal\",\"Flying\"],\"favourite\":false},{\"id\":\"086\",\"name\":\"Seel\",\"image\":\"https://img.pokemondb.net/artwork/seel.jpg\",\"types\":[\"Water\"],\"favourite\":false},{\"id\":\"087\",\"name\":\"Dewgong\",\"image\":\"https://img.pokemondb.net/artwork/dewgong.jpg\",\"types\":[\"Water\",\"Ice\"],\"favourite\":false},{\"id\":\"088\",\"name\":\"Grimer\",\"image\":\"https://img.pokemondb.net/artwork/grimer.jpg\",\"types\":[\"Poison\"],\"favourite\":false},{\"id\":\"089\",\"name\":\"Muk\",\"image\":\"https://img.pokemondb.net/artwork/muk.jpg\",\"types\":[\"Poison\"],\"favourite\":false},{\"id\":\"090\",\"name\":\"Shellder\",\"image\":\"https://img.pokemondb.net/artwork/shellder.jpg\",\"types\":[\"Water\"],\"favourite\":false},{\"id\":\"091\",\"name\":\"Cloyster\",\"image\":\"https://img.pokemondb.net/artwork/cloyster.jpg\",\"types\":[\"Water\",\"Ice\"],\"favourite\":false},{\"id\":\"092\",\"name\":\"Gastly\",\"image\":\"https://img.pokemondb.net/artwork/gastly.jpg\",\"types\":[\"Ghost\",\"Poison\"],\"favourite\":false},{\"id\":\"093\",\"name\":\"Haunter\",\"image\":\"https://img.pokemondb.net/artwork/haunter.jpg\",\"types\":[\"Ghost\",\"Poison\"],\"favourite\":false},{\"id\":\"094\",\"name\":\"Gengar\",\"image\":\"https://img.pokemondb.net/artwork/gengar.jpg\",\"types\":[\"Ghost\",\"Poison\"],\"favourite\":false},{\"id\":\"095\",\"name\":\"Onix\",\"image\":\"https://img.pokemondb.net/artwork/onix.jpg\",\"types\":[\"Rock\",\"Ground\"],\"favourite\":false},{\"id\":\"096\",\"name\":\"Drowzee\",\"image\":\"https://img.pokemondb.net/artwork/drowzee.jpg\",\"types\":[\"Psychic\"],\"favourite\":false},{\"id\":\"097\",\"name\":\"Hypno\",\"image\":\"https://img.pokemondb.net/artwork/hypno.jpg\",\"types\":[\"Psychic\"],\"favourite\":false},{\"id\":\"098\",\"name\":\"Krabby\",\"image\":\"https://img.pokemondb.net/artwork/krabby.jpg\",\"types\":[\"Water\"],\"favourite\":false},{\"id\":\"099\",\"name\":\"Kingler\",\"image\":\"https://img.pokemondb.net/artwork/kingler.jpg\",\"types\":[\"Water\"],\"favourite\":false},{\"id\":\"100\",\"name\":\"Voltorb\",\"image\":\"https://img.pokemondb.net/artwork/voltorb.jpg\",\"types\":[\"Electric\"],\"favourite\":false},{\"id\":\"101\",\"name\":\"Electrode\",\"image\":\"https://img.pokemondb.net/artwork/electrode.jpg\",\"types\":[\"Electric\"],\"favourite\":false},{\"id\":\"102\",\"name\":\"Exeggcute\",\"image\":\"https://img.pokemondb.net/artwork/exeggcute.jpg\",\"types\":[\"Grass\",\"Psychic\"],\"favourite\":false},{\"id\":\"103\",\"name\":\"Exeggutor\",\"image\":\"https://img.pokemondb.net/artwork/exeggutor.jpg\",\"types\":[\"Grass\",\"Psychic\"],\"favourite\":false},{\"id\":\"104\",\"name\":\"Cubone\",\"image\":\"https://img.pokemondb.net/artwork/cubone.jpg\",\"types\":[\"Ground\"],\"favourite\":false},{\"id\":\"105\",\"name\":\"Marowak\",\"image\":\"https://img.pokemondb.net/artwork/marowak.jpg\",\"types\":[\"Ground\"],\"favourite\":false},{\"id\":\"106\",\"name\":\"Hitmonlee\",\"image\":\"https://img.pokemondb.net/artwork/hitmonlee.jpg\",\"types\":[\"Fighting\"],\"favourite\":false},{\"id\":\"107\",\"name\":\"Hitmonchan\",\"image\":\"https://img.pokemondb.net/artwork/hitmonchan.jpg\",\"types\":[\"Fighting\"],\"favourite\":false},{\"id\":\"108\",\"name\":\"Lickitung\",\"image\":\"https://img.pokemondb.net/artwork/lickitung.jpg\",\"types\":[\"Normal\"],\"favourite\":false},{\"id\":\"109\",\"name\":\"Koffing\",\"image\":\"https://img.pokemondb.net/artwork/koffing.jpg\",\"types\":[\"Poison\"],\"favourite\":false},{\"id\":\"110\",\"name\":\"Weezing\",\"image\":\"https://img.pokemondb.net/artwork/weezing.jpg\",\"types\":[\"Poison\"],\"favourite\":false},{\"id\":\"111\",\"name\":\"Rhyhorn\",\"image\":\"https://img.pokemondb.net/artwork/rhyhorn.jpg\",\"types\":[\"Ground\",\"Rock\"],\"favourite\":false},{\"id\":\"112\",\"name\":\"Rhydon\",\"image\":\"https://img.pokemondb.net/artwork/rhydon.jpg\",\"types\":[\"Ground\",\"Rock\"],\"favourite\":false},{\"id\":\"113\",\"name\":\"Chansey\",\"image\":\"https://img.pokemondb.net/artwork/chansey.jpg\",\"types\":[\"Normal\"],\"favourite\":false},{\"id\":\"114\",\"name\":\"Tangela\",\"image\":\"https://img.pokemondb.net/artwork/tangela.jpg\",\"types\":[\"Grass\"],\"favourite\":false},{\"id\":\"115\",\"name\":\"Kangaskhan\",\"image\":\"https://img.pokemondb.net/artwork/kangaskhan.jpg\",\"types\":[\"Normal\"],\"favourite\":false},{\"id\":\"116\",\"name\":\"Horsea\",\"image\":\"https://img.pokemondb.net/artwork/horsea.jpg\",\"types\":[\"Water\"],\"favourite\":false},{\"id\":\"117\",\"name\":\"Seadra\",\"image\":\"https://img.pokemondb.net/artwork/seadra.jpg\",\"types\":[\"Water\"],\"favourite\":false},{\"id\":\"118\",\"name\":\"Goldeen\",\"image\":\"https://img.pokemondb.net/artwork/goldeen.jpg\",\"types\":[\"Water\"],\"favourite\":false},{\"id\":\"119\",\"name\":\"Seaking\",\"image\":\"https://img.pokemondb.net/artwork/seaking.jpg\",\"types\":[\"Water\"],\"favourite\":false},{\"id\":\"120\",\"name\":\"Staryu\",\"image\":\"https://img.pokemondb.net/artwork/staryu.jpg\",\"types\":[\"Water\"],\"favourite\":false},{\"id\":\"121\",\"name\":\"Starmie\",\"image\":\"https://img.pokemondb.net/artwork/starmie.jpg\",\"types\":[\"Water\",\"Psychic\"],\"favourite\":false},{\"id\":\"122\",\"name\":\"Mr. Mime\",\"image\":\"https://img.pokemondb.net/artwork/mr.-mime.jpg\",\"types\":[\"Psychic\",\"Fairy\"],\"favourite\":false},{\"id\":\"123\",\"name\":\"Scyther\",\"image\":\"https://img.pokemondb.net/artwork/scyther.jpg\",\"types\":[\"Bug\",\"Flying\"],\"favourite\":false},{\"id\":\"124\",\"name\":\"Jynx\",\"image\":\"https://img.pokemondb.net/artwork/jynx.jpg\",\"types\":[\"Ice\",\"Psychic\"],\"favourite\":false},{\"id\":\"125\",\"name\":\"Electabuzz\",\"image\":\"https://img.pokemondb.net/artwork/electabuzz.jpg\",\"types\":[\"Electric\"],\"favourite\":false},{\"id\":\"126\",\"name\":\"Magmar\",\"image\":\"https://img.pokemondb.net/artwork/magmar.jpg\",\"types\":[\"Fire\"],\"favourite\":false},{\"id\":\"127\",\"name\":\"Pinsir\",\"image\":\"https://img.pokemondb.net/artwork/pinsir.jpg\",\"types\":[\"Bug\"],\"favourite\":false},{\"id\":\"128\",\"name\":\"Tauros\",\"image\":\"https://img.pokemondb.net/artwork/tauros.jpg\",\"types\":[\"Normal\"],\"favourite\":false},{\"id\":\"129\",\"name\":\"Magikarp\",\"image\":\"https://img.pokemondb.net/artwork/magikarp.jpg\",\"types\":[\"Water\"],\"favourite\":false},{\"id\":\"130\",\"name\":\"Gyarados\",\"image\":\"https://img.pokemondb.net/artwork/gyarados.jpg\",\"types\":[\"Water\",\"Flying\"],\"favourite\":false},{\"id\":\"131\",\"name\":\"Lapras\",\"image\":\"https://img.pokemondb.net/artwork/lapras.jpg\",\"types\":[\"Water\",\"Ice\"],\"favourite\":false},{\"id\":\"132\",\"name\":\"Ditto\",\"image\":\"https://img.pokemondb.net/artwork/ditto.jpg\",\"types\":[\"Normal\"],\"favourite\":false},{\"id\":\"133\",\"name\":\"Eevee\",\"image\":\"https://img.pokemondb.net/artwork/eevee.jpg\",\"types\":[\"Normal\"],\"favourite\":false},{\"id\":\"134\",\"name\":\"Vaporeon\",\"image\":\"https://img.pokemondb.net/artwork/vaporeon.jpg\",\"types\":[\"Water\"],\"favourite\":false},{\"id\":\"135\",\"name\":\"Jolteon\",\"image\":\"https://img.pokemondb.net/artwork/jolteon.jpg\",\"types\":[\"Electric\"],\"favourite\":false},{\"id\":\"136\",\"name\":\"Flareon\",\"image\":\"https://img.pokemondb.net/artwork/flareon.jpg\",\"types\":[\"Fire\"],\"favourite\":false},{\"id\":\"137\",\"name\":\"Porygon\",\"image\":\"https://img.pokemondb.net/artwork/porygon.jpg\",\"types\":[\"Normal\"],\"favourite\":false},{\"id\":\"138\",\"name\":\"Omanyte\",\"image\":\"https://img.pokemondb.net/artwork/omanyte.jpg\",\"types\":[\"Rock\",\"Water\"],\"favourite\":false},{\"id\":\"139\",\"name\":\"Omastar\",\"image\":\"https://img.pokemondb.net/artwork/omastar.jpg\",\"types\":[\"Rock\",\"Water\"],\"favourite\":false},{\"id\":\"140\",\"name\":\"Kabuto\",\"image\":\"https://img.pokemondb.net/artwork/kabuto.jpg\",\"types\":[\"Rock\",\"Water\"],\"favourite\":false},{\"id\":\"141\",\"name\":\"Kabutops\",\"image\":\"https://img.pokemondb.net/artwork/kabutops.jpg\",\"types\":[\"Rock\",\"Water\"],\"favourite\":false},{\"id\":\"142\",\"name\":\"Aerodactyl\",\"image\":\"https://img.pokemondb.net/artwork/aerodactyl.jpg\",\"types\":[\"Rock\",\"Flying\"],\"favourite\":false},{\"id\":\"143\",\"name\":\"Snorlax\",\"image\":\"https://img.pokemondb.net/artwork/snorlax.jpg\",\"types\":[\"Normal\"],\"favourite\":false},{\"id\":\"144\",\"name\":\"Articuno\",\"image\":\"https://img.pokemondb.net/artwork/articuno.jpg\",\"types\":[\"Ice\",\"Flying\"],\"favourite\":false},{\"id\":\"145\",\"name\":\"Zapdos\",\"image\":\"https://img.pokemondb.net/artwork/zapdos.jpg\",\"types\":[\"Electric\",\"Flying\"],\"favourite\":false},{\"id\":\"146\",\"name\":\"Moltres\",\"image\":\"https://img.pokemondb.net/artwork/moltres.jpg\",\"types\":[\"Fire\",\"Flying\"],\"favourite\":false},{\"id\":\"147\",\"name\":\"Dratini\",\"image\":\"https://img.pokemondb.net/artwork/dratini.jpg\",\"types\":[\"Dragon\"],\"favourite\":false},{\"id\":\"148\",\"name\":\"Dragonair\",\"image\":\"https://img.pokemondb.net/artwork/dragonair.jpg\",\"types\":[\"Dragon\"],\"favourite\":false},{\"id\":\"149\",\"name\":\"Dragonite\",\"image\":\"https://img.pokemondb.net/artwork/dragonite.jpg\",\"types\":[\"Dragon\",\"Flying\"],\"favourite\":false},{\"id\":\"150\",\"name\":\"Mewtwo\",\"image\":\"https://img.pokemondb.net/artwork/mewtwo.jpg\",\"types\":[\"Psychic\"],\"favourite\":false},{\"id\":\"151\",\"name\":\"Mew\",\"image\":\"https://img.pokemondb.net/artwork/mew.jpg\",\"types\":[\"Psychic\"],\"favourite\":false}]";

    final String response = findAllPokemons("/pokedex/pokemon");

    assertEquals(allPokemons, response);
  }

  @Order(2)
  @Test
  void givenDbClean_whenFindAllGhosts_thenAllGhosts() throws Exception {
    final var ghostPokemons = "[{\"id\":\"092\",\"name\":\"Gastly\",\"image\":\"https://img.pokemondb.net/artwork/gastly.jpg\",\"types\":[\"Ghost\",\"Poison\"],\"favourite\":false},{\"id\":\"093\",\"name\":\"Haunter\",\"image\":\"https://img.pokemondb.net/artwork/haunter.jpg\",\"types\":[\"Ghost\",\"Poison\"],\"favourite\":false},{\"id\":\"094\",\"name\":\"Gengar\",\"image\":\"https://img.pokemondb.net/artwork/gengar.jpg\",\"types\":[\"Ghost\",\"Poison\"],\"favourite\":false}]";

    final String response = findAllPokemons("/pokedex/pokemon?type=Ghost");

    assertEquals(ghostPokemons, response);
  }

  @Order(3)
  @Test
  void givenDbClean_whenFindAllWithNameSaur_thenAllSaurs() throws Exception {
    final var pokemonsNamedSaur = "[{\"id\":\"001\",\"name\":\"Bulbasaur\",\"image\":\"https://img.pokemondb.net/artwork/bulbasaur.jpg\",\"types\":[\"Grass\",\"Poison\"],\"favourite\":false},{\"id\":\"002\",\"name\":\"Ivysaur\",\"image\":\"https://img.pokemondb.net/artwork/ivysaur.jpg\",\"types\":[\"Grass\",\"Poison\"],\"favourite\":false},{\"id\":\"003\",\"name\":\"Venusaur\",\"image\":\"https://img.pokemondb.net/artwork/venusaur.jpg\",\"types\":[\"Grass\",\"Poison\"],\"favourite\":false}]";

    final String response = findAllPokemons("/pokedex/pokemon?name=saur");

    assertEquals(pokemonsNamedSaur, response);
  }

  @Order(4)
  @Test
  void givenDbClean_whenFindAllWithNameEonAndElectric_thenGetJolteon() throws Exception {
    final var electricPokemonsNamedEon = "[{\"id\":\"135\",\"name\":\"Jolteon\",\"image\":\"https://img.pokemondb.net/artwork/jolteon.jpg\",\"types\":[\"Electric\"],\"favourite\":false}]";

    final String response = findAllPokemons("/pokedex/pokemon?name=eon&type=Electric");

    assertEquals(electricPokemonsNamedEon, response);
  }


  @Order(5)
  @Test
  void givenDbClean_whenGet151_thenGetMew() throws Exception {
    final var completeMew = "{\"id\":\"151\",\"name\":\"Mew\",\"weight\":{\"minimum\":\"3.5kg\",\"maximum\":\"4.5kg\"},\"height\":{\"minimum\":\"0.35m\",\"maximum\":\"0.45m\"},\"types\":[\"Psychic\"],\"maxCP\":3087,\"maxHP\":3299,\"image\":\"https://img.pokemondb.net/artwork/mew.jpg\",\"sound\":\"http://localhost:8080/sounds/151.mp3\",\"favourite\":false,\"evolutions\":null}";

    final String response = findAllPokemons("/pokedex/pokemon/151");

    assertEquals(completeMew, response);
  }


  @Order(6)
  @Test
  void given151AddedFavourite__whenGet151_thenGetMewAsFavourite() throws Exception {
    addFavourite("151");

    final var favouriteMew = "{\"id\":\"151\",\"name\":\"Mew\",\"weight\":{\"minimum\":\"3.5kg\",\"maximum\":\"4.5kg\"},\"height\":{\"minimum\":\"0.35m\",\"maximum\":\"0.45m\"},\"types\":[\"Psychic\"],\"maxCP\":3087,\"maxHP\":3299,\"image\":\"https://img.pokemondb.net/artwork/mew.jpg\",\"sound\":\"http://localhost:8080/sounds/151.mp3\",\"favourite\":true,\"evolutions\":null}";

    final String response = findAllPokemons("/pokedex/pokemon/151");

    assertEquals(favouriteMew, response);
  }

  @Order(7)
  @Test
  void given151AddedFavouriteAndRemoved_whenGet151_thenGetMewAsNotFavourite() throws Exception {
    addFavourite("151");
    deleteFavourite("151");

    final var mewNotFavourite = "{\"id\":\"151\",\"name\":\"Mew\",\"weight\":{\"minimum\":\"3.5kg\",\"maximum\":\"4.5kg\"},\"height\":{\"minimum\":\"0.35m\",\"maximum\":\"0.45m\"},\"types\":[\"Psychic\"],\"maxCP\":3087,\"maxHP\":3299,\"image\":\"https://img.pokemondb.net/artwork/mew.jpg\",\"sound\":\"http://localhost:8080/sounds/151.mp3\",\"favourite\":false,\"evolutions\":null}";

    final String response = findAllPokemons("/pokedex/pokemon/151");

    assertEquals(mewNotFavourite, response);
  }

  @Order(8)
  @Test
  void given150And151AddedAsFavourite_whenGetAllFavourites_thenGet150And151() throws Exception {
    addFavourite("151");
    addFavourite("150");

    final var only150And151 = "[{\"id\":\"150\",\"name\":\"Mewtwo\",\"image\":\"https://img.pokemondb.net/artwork/mewtwo.jpg\",\"types\":[\"Psychic\"],\"favourite\":true},{\"id\":\"151\",\"name\":\"Mew\",\"image\":\"https://img.pokemondb.net/artwork/mew.jpg\",\"types\":[\"Psychic\"],\"favourite\":true}]";

    final String response = findAllPokemons("/pokedex/pokemon?favourite=true");

    assertEquals(only150And151, response);
  }

  private void addFavourite(String pokemonId) throws Exception {
    mvc.perform(post("/pokedex/pokemon/favourite/{id}", pokemonId));
  }

  private void deleteFavourite(String pokemonId) throws Exception {
    mvc.perform(delete("/pokedex/pokemon/favourite/{id}", pokemonId));
  }


  private String findAllPokemons(String s) throws Exception {
    return mvc.perform(get(s)
            .contentType(MediaType.APPLICATION_JSON)
            .accept(MediaType.APPLICATION_JSON))
        .andExpect(status().isOk())
        .andDo(print())
        .andReturn()
        .getResponse()
        .getContentAsString();
  }
}
